<!DOCTYPE html>
<html>
    <head>
        <title>Cosmogony Volumetric Data Dashboard</title>
        <meta charset='utf-8'/>
        <meta name='viewport' content='initial-scale=1,user-scalable=yes'/>
        <style>
            table,
            td,
            th {
                margin: 10px 0;
                padding: 2px 4px;
                text-align: center;
                border-collapse: collapse;
            }
            td,
            th {
                border: 1px solid black;
            }
        </style>
    </head>
    <body>
        <article>
            <h2>Cosmogony metrics</h2>
            <p>You can check below the number of zones by country for each type of zone, and compare this number with
                <a href="https://github.com/osm-without-borders/cosmogony-data-dashboard#reference-values">the actual number of zones in the real world</a>.

                <details>
                    <ul>
                        <li>✅✅ : ok
                        <li>❌❌ : ko, too few or too many zones
                        <li>❌ known failure : we know that somes zones are still missing in OpenStreetMap
                        <li>✅✌ : we did think that some zones were missing in OpenStreetMap, but it's actually ok
                        <li>skipped : the country was not found in the Cosmogony file
                    </ul>
                </details>
            </p>
            <p>
                <h3>Wanna help ?</h3>
                Cosmogony, just like OpenStreetMap, emphasizes local knowledge.
                <ul>
                    <li>
                        <a href="https://github.com/osm-without-borders/cosmogony-data-dashboard/blob/master/reference_stats_values.csv">tell us</a>
                        the actual number of zones for the countries you know about
                    <li>patch or add the missing zones in
                        <a href="https://wiki.openstreetmap.org/wiki/Relation:boundary">OpenStreetMap</a>
                </ul>
            </p>

        </article>
        <table id="volumetric-dashboard" class="sort"></table>
        <script>
            fetch(`data_volumetric.json`).then((r) => r.json()).then((data) => {
                var table = document.getElementById('volumetric-dashboard');

                var col = ['name', 'zone_type', 'result', 'status']

                for (var i = 0; i < data.length; i++) {
                    var result_text = `${ (data[i]['total'] != -1)
                        ? data[i]['total']
                        : "??"} `
                    result_text += `<br>(expected : ${data[i]['expected_min']} ~ ${data[i]['expected_max']})`

                    var status = ''
                    if (data[i]['test_status'] == 'ok') {
                        status = '✅'
                        status += (data[i]['is_known_failure'] == "yes")
                            ? " ✌ "
                            : "✅";
                    }
                    if (data[i]['test_status'] == 'ko') {
                        status += (data[i]['is_known_failure'] == "yes")
                            ? "❌ <br> known failure"
                            : "❌❌";
                    }
                    if (data[i]['test_status'] == 'skip') {
                        status = 'skipped'
                    }

                    var tr = table.insertRow(-1);
                    tr.insertCell(-1).innerHTML = data[i]['name']
                    tr.insertCell(-1).innerHTML = data[i]['zone_type']
                    var tabCell = tr.insertCell(-1);
                    tabCell.innerHTML = result_text;
                    tr.insertCell(-1).innerHTML = status

                }
                var header = table.createTHead();
                var trh = header.insertRow(0);
                for (var i = 0; i < col.length; i++) {
                    var th = document.createElement("th");
                    th.innerHTML = col[i];
                    trh.appendChild(th);
                }

            })
        </script>

    </body>
</html>
